/*! qajax 0.1.1 - Simple Promise ajax library based on Q */
!function(a){"object"==typeof exports?module.exports=a():window.Qajax=a()}(function(){"use strict";var a="Content-Type",b=function(d){if(!d)throw"Qajax: settings is required";if("string"==typeof d&&(d={url:d}),!d.url)throw"Qajax: settings.url is required";return Q.fcall(function(){var e=d.xhr||new XMLHttpRequest,f=d.method||"GET",g=d.url,h=d.data,i=d.timeout||b.TIMEOUT,j=Q.defer(),k=d.headers||{},l=(-1===g.indexOf("?")?"?":"&")+"_="+(new Date).getTime();null!==h&&"object"==typeof h&&(a in k||(k[a]="application/json"),h=JSON.stringify(h)),e.onreadystatechange=function(){if(4===e.readyState)try{c(f+" "+g+" => "+e.status),e.status?j.resolve(e):j.reject(e)}catch(a){j.reject(e)}},e.open(f,g+l,!0);for(var m in k)k.hasOwnProperty(m)&&e.setRequestHeader(m,k[m]);return void 0!==h&&null!==h?e.send(h):e.send(),j.promise.timeout(i).fail(function(a){throw a instanceof Error&&(c("Qajax request delay reach in "+f+" "+g),e.abort()),e})})};b.TIMEOUT=6e4,b.filterStatus=function(a){var b,d;if(d=typeof a,"function"===d)b=a;else{if("number"!==d)throw"validStatus type "+d+" unsupported";b=function(b){return b===a}}return function(a){var d=0;try{d=a.status}catch(e){c("Qajax: failed to read xhr.status")}return 1223===d&&(d=204),b(d)?Q.resolve(a):Q.reject(a)}},b.filterSuccess=b.filterStatus(function(a){return a>=200&&300>a||304===a}),b.toJSON=function(a){return Q.fcall(function(){return JSON.parse(a.responseText)})},b.getJSON=function(a){return b({url:a,method:"GET"}).then(b.filterSuccess).then(b.toJSON)},b.serialize=function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(encodeURIComponent(b)+"="+encodeURIComponent(a[b]));return c.join("&")};var c=function(a){window.console&&console.log(a)};return b});